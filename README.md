# fpgaNeuralNetPara8
FPGAでニューラルネットワークの推論を組み込んで実験しました。いわゆるニューラルネットワークチップというものです。
2018年頃、電子工作で作りました。AIチップをどうやってFPGAで組むのか、その手助けになればと、参考用に、古いコードを公開することにしました。

1.17秒で4992文字をAI判定させます。

回路は、1コアにつき3個のスレッド、それを8段重ねて、合計24個のスレッドが同時に画像イメージを判定します。
画面上に表示されている画像と、その上に推論の、第１候補、第2候補、通し番号、が表示されます。
画像の3段目が緑色なのは、論理回路の制限で、評価ボードの論理数が不足した為、その部分の結線をあきらめた空白です。

FPGAボードは terasic DE0-Nano (ALTERA Cyclone IV EP4CE22F17C6N FPGA)　です。  
開発ツールはQuartus Prime Version 17 Lite Edition（無償版）です。  
表示は標準の液晶モニター、VGA（640x480）です。

テスト用の画像データは、あらかじめ用意しておいたRaspberryPiにあります。
そこから転送プログラムでSPI通信を通し、FPGAボード側で受信したのち、SDRAMに書き込みます。
学習済みデータはFPGA（Cyclone IV）内部のエンベデッド・メモリー（M9K）に置きます。
FPGAからVGA接続した液晶モニターに判定画像と判定結果を表示します。

SPI通信と、SDRAMコントローラと、VGA表示回路は自作しました。
DRAM制御はバーストモードを使っているので、最速に近いと思います。リフレッシュも限界までチューニングしました。

テストデータと学習データは教科書にある、古典的なものです。参考書やネットでも見つかります。
ニューラルネットは3段です。整数計算を１ビットずつ、限界ギリギリまで削って、回路数を節約してあります。

2018年に、なぜ、ここまで情熱的に、AIの電子回路を作ろうと思ったのか今思うと不思議ですね。
世界中で同時期に似たような発明がされていたので、人類のマイルストーンの一つ、なのかな。

Verilogで組んだニューラルネットのコードは難解なので、ダイアグラム（図）も用意しました。

Verilogで書かれたコード.vファイルのインデント（字下げ）が見づらいのでブラウザのURL欄の文末に「?ts=3」をつけると
空白が揃うようになります。

VGA output.
!["picture"](vga20250519a.jpg)

circuit diagram of this code.
!["picture"](dia20250519a.jpg)

r.h 2025/5/20
